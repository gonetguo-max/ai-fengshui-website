# ä¸‰å±‚çº§ä»˜è´¹ç³»ç»Ÿå®æ–½è®¡åˆ’

## ğŸ“‹ æ€»ä½“å®æ–½ç­–ç•¥

### ğŸ¯ æ ¸å¿ƒåŸåˆ™
1. **æ¸è¿›å¼å¼€å‘**ï¼šåœ¨ç°æœ‰ç³»ç»ŸåŸºç¡€ä¸Šé€æ­¥æ·»åŠ ä»˜è´¹åŠŸèƒ½
2. **ç”¨æˆ·ä½“éªŒä¼˜å…ˆ**ï¼šç¡®ä¿ä»˜è´¹æµç¨‹é¡ºç•…ï¼Œä»·å€¼æ¸…æ™°
3. **æŠ€æœ¯ç¨³å®šæ€§**ï¼šä¸ç ´åç°æœ‰åŠŸèƒ½ï¼Œå‘åå…¼å®¹
4. **å¿«é€ŸéªŒè¯**ï¼šå°½å¿«ä¸Šçº¿MVPéªŒè¯å•†ä¸šæ¨¡å¼

---

## ğŸ—“ï¸ è¯¦ç»†å¼€å‘è®¡åˆ’ (4å‘¨)

### ğŸ“… **ç¬¬1å‘¨ï¼šåŸºç¡€æ¶æ„å’Œç”¨æˆ·ç³»ç»Ÿ**

#### ğŸ—ï¸ Day 1-2: ç”¨æˆ·è®¤è¯ç³»ç»Ÿ
- [ ] ç®€å•çš„ç”¨æˆ·æ³¨å†Œ/ç™»å½•ç•Œé¢
- [ ] JWTä»¤ç‰Œè®¤è¯ç³»ç»Ÿ
- [ ] æœ¬åœ°å­˜å‚¨ç”¨æˆ·çŠ¶æ€
- [ ] å¯†ç åŠ å¯†å’ŒéªŒè¯

#### ğŸ‘¤ Day 3-4: ç”¨æˆ·ç­‰çº§ç®¡ç†
- [ ] ç”¨æˆ·ç­‰çº§æ•°æ®åº“è®¾è®¡
- [ ] ä¸‰å±‚çº§æƒé™æ§åˆ¶ç³»ç»Ÿ
- [ ] ä½¿ç”¨æ¬¡æ•°è·Ÿè¸ªå’Œé™åˆ¶
- [ ] ç”¨æˆ·ä»ªè¡¨æ¿åŸºç¡€ç•Œé¢

#### ğŸ’¾ Day 5-7: æ•°æ®å­˜å‚¨ä¼˜åŒ–
- [ ] ç”¨æˆ·æ•°æ®è¡¨ç»“æ„è®¾è®¡
- [ ] æŠ¥å‘Šå†å²è®°å½•å­˜å‚¨
- [ ] æ”¯ä»˜è®°å½•æ•°æ®è¡¨
- [ ] æ•°æ®å¤‡ä»½å’Œæ¢å¤æœºåˆ¶

---

### ğŸ“… **ç¬¬2å‘¨ï¼šæ”¯ä»˜ç³»ç»Ÿé›†æˆ**

#### ğŸ’³ Day 8-10: Stripeæ”¯ä»˜é›†æˆ
- [ ] Stripeè´¦æˆ·é…ç½®
- [ ] æ”¯ä»˜é¡µé¢è®¾è®¡
- [ ] è®¢é˜…ç®¡ç†ç³»ç»Ÿ
- [ ] Webhookå¤„ç†æ”¯ä»˜çŠ¶æ€

#### ğŸ” Day 11-12: å®‰å…¨å’ŒéªŒè¯
- [ ] æ”¯ä»˜å®‰å…¨éªŒè¯
- [ ] è®¢å•çŠ¶æ€ç®¡ç†
- [ ] é€€æ¬¾å¤„ç†æœºåˆ¶
- [ ] æ”¯ä»˜å¤±è´¥é‡è¯•é€»è¾‘

#### ğŸ¨ Day 13-14: ä»˜è´¹ç•Œé¢ä¼˜åŒ–
- [ ] ä»·æ ¼å¯¹æ¯”é¡µé¢
- [ ] "å‡çº§è´¦æˆ·"å¼•å¯¼æµç¨‹
- [ ] æ”¯ä»˜æˆåŠŸ/å¤±è´¥é¡µé¢
- [ ] è´­ä¹°ç¡®è®¤é‚®ä»¶

---

### ğŸ“… **ç¬¬3å‘¨ï¼šæŠ¥å‘Šç³»ç»Ÿåˆ†çº§**

#### ğŸ“Š Day 15-17: å…è´¹ç‰ˆæŠ¥å‘Šé™åˆ¶
- [ ] ç®€åŒ–ç‰ˆåˆ†ææç¤ºè¯
- [ ] åŸºç¡€æ¨¡æ¿æŠ¥å‘Šæ ¼å¼
- [ ] åŠŸèƒ½é™åˆ¶æç¤º
- [ ] "å‡çº§è§£é”"æŒ‰é’®

#### ğŸ’« Day 18-19: è¿›é˜¶ç‰ˆæŠ¥å‘ŠåŠŸèƒ½
- [ ] è¯¦ç»†åˆ†ææç¤ºè¯ä¼˜åŒ–
- [ ] æˆ·å‹å›¾ä¸Šä¼ åŠŸèƒ½
- [ ] æ—¶é—´å»ºè®®ç®—æ³•
- [ ] ä¸“ä¸šPDFæ¨¡æ¿

#### ğŸ† Day 20-21: é«˜çº§ç‰ˆç‹¬å åŠŸèƒ½
- [ ] åŒAIå¼•æ“äº¤å‰éªŒè¯
- [ ] ä¸ªæ€§åŒ–æ·±åº¦åˆ†æ
- [ ] 3Då¯è§†åŒ–åŸå‹
- [ ] VIPä¸“å±ç•Œé¢æ ‡è¯†

---

### ğŸ“… **ç¬¬4å‘¨ï¼šæµ‹è¯•å’Œä¼˜åŒ–**

#### ğŸ§ª Day 22-24: åŠŸèƒ½æµ‹è¯•
- [ ] æ”¯ä»˜æµç¨‹å®Œæ•´æµ‹è¯•
- [ ] ç”¨æˆ·ç­‰çº§åˆ‡æ¢æµ‹è¯•
- [ ] æŠ¥å‘Šç”Ÿæˆè´¨é‡éªŒè¯
- [ ] é”™è¯¯å¤„ç†å’Œå¼‚å¸¸æ¢å¤

#### ğŸ¯ Day 25-26: ç”¨æˆ·ä½“éªŒä¼˜åŒ–
- [ ] ç•Œé¢å“åº”é€Ÿåº¦ä¼˜åŒ–
- [ ] ä»·æ ¼å±•ç¤ºå¿ƒç†å­¦ä¼˜åŒ–
- [ ] è½¬åŒ–ç‡å…³é”®èŠ‚ç‚¹ä¼˜åŒ–
- [ ] ç§»åŠ¨ç«¯æ”¯ä»˜æµç¨‹æµ‹è¯•

#### ğŸš€ Day 27-28: ä¸Šçº¿å‡†å¤‡
- [ ] ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
- [ ] ç›‘æ§å’Œæ—¥å¿—ç³»ç»Ÿ
- [ ] å®¢æœæ”¯æŒå‡†å¤‡
- [ ] è¥é”€ç´ æå‡†å¤‡

---

## ğŸ› ï¸ å…·ä½“æŠ€æœ¯å®ç°

### 1ï¸âƒ£ ç”¨æˆ·è®¤è¯ç³»ç»Ÿ

```javascript
// ç®€å•çš„ç”¨æˆ·è®¤è¯æ¨¡å—
class UserAuth {
  constructor() {
    this.users = new Map(); // å¼€å‘é˜¶æ®µç”¨å†…å­˜å­˜å‚¨
    this.sessions = new Map();
  }

  async register(email, password) {
    // ç”¨æˆ·æ³¨å†Œé€»è¾‘
    const hashedPassword = await this.hashPassword(password);
    const user = {
      id: this.generateId(),
      email,
      password: hashedPassword,
      tier: 'FREE',
      createdAt: new Date(),
      requestCount: 0
    };
    this.users.set(email, user);
    return this.createSession(user);
  }

  async login(email, password) {
    // ç™»å½•éªŒè¯é€»è¾‘
    const user = this.users.get(email);
    if (user && await this.verifyPassword(password, user.password)) {
      return this.createSession(user);
    }
    throw new Error('Invalid credentials');
  }
}
```

### 2ï¸âƒ£ ç”¨æˆ·ç­‰çº§ç®¡ç†

```javascript
// ç”¨æˆ·ç­‰çº§ç®¡ç†ç³»ç»Ÿ
const USER_TIERS = {
  FREE: {
    name: 'å…è´¹ç‰ˆ',
    maxRequests: 3,
    features: ['basic_analysis', 'text_export'],
    aiModel: 'qwen3',
    reportTemplate: 'basic'
  },
  PREMIUM: {
    name: 'è¿›é˜¶ç‰ˆ',
    price: 4.99,
    maxRequests: 10,
    features: ['detailed_analysis', 'image_upload', 'pdf_export', 'time_advice'],
    aiModel: 'deepseek-r1',
    reportTemplate: 'premium'
  },
  VIP: {
    name: 'é«˜çº§ç‰ˆ',
    price: 29.90,
    maxRequests: -1, // æ— é™åˆ¶
    features: ['master_analysis', '3d_visualization', 'personal_consultation'],
    aiModel: 'dual-engine',
    reportTemplate: 'vip'
  }
};

class TierManager {
  static canUseFeature(userTier, feature) {
    return USER_TIERS[userTier].features.includes(feature);
  }

  static hasRequestsLeft(user) {
    const tierConfig = USER_TIERS[user.tier];
    return tierConfig.maxRequests === -1 || user.requestCount < tierConfig.maxRequests;
  }
}
```

### 3ï¸âƒ£ æ”¯ä»˜ç³»ç»Ÿé›†æˆ

```javascript
// Stripeæ”¯ä»˜é›†æˆ
const stripe = require('stripe')(process.env.STRIPE_SECRET_KEY);

class PaymentProcessor {
  async createPaymentSession(userId, tier) {
    const priceConfig = USER_TIERS[tier];
    
    const session = await stripe.checkout.sessions.create({
      customer_email: user.email,
      payment_method_types: ['card'],
      line_items: [{
        price_data: {
          currency: 'usd',
          product_data: {
            name: `é£æ°´å¤§å¸ˆ${priceConfig.name}`,
            description: `ä¸“ä¸šé£æ°´åˆ†æ - ${priceConfig.name}`
          },
          unit_amount: priceConfig.price * 100, // Stripeä½¿ç”¨åˆ†ä¸ºå•ä½
        },
        quantity: 1,
      }],
      mode: 'payment',
      success_url: `${process.env.BASE_URL}/payment/success?session_id={CHECKOUT_SESSION_ID}`,
      cancel_url: `${process.env.BASE_URL}/payment/cancel`,
      metadata: {
        userId: userId,
        tier: tier
      }
    });

    return session;
  }

  async handleWebhook(sig, body) {
    const event = stripe.webhooks.constructEvent(body, sig, process.env.STRIPE_WEBHOOK_SECRET);
    
    switch (event.type) {
      case 'checkout.session.completed':
        await this.upgradeuserTier(event.data.object);
        break;
      case 'payment_intent.payment_failed':
        await this.handlePaymentFailure(event.data.object);
        break;
    }
  }
}
```

### 4ï¸âƒ£ åˆ†å±‚æŠ¥å‘Šç”Ÿæˆå™¨

```javascript
// å‡çº§ç‰ˆé£æ°´åˆ†æå™¨
class TieredFengshuiAnalyzer extends FengshuiAnalyzer {
  constructor() {
    super();
    this.reportTemplates = {
      basic: new BasicReportTemplate(),
      premium: new PremiumReportTemplate(),
      vip: new VIPReportTemplate()
    };
  }

  async analyzeFengshui(data, userTier) {
    // æ ¹æ®ç”¨æˆ·ç­‰çº§é€‰æ‹©AIæ¨¡å‹å’Œåˆ†ææ·±åº¦
    const tierConfig = USER_TIERS[userTier];
    const aiModel = this.selectAIModel(tierConfig.aiModel);
    const prompt = this.buildTieredPrompt(data, userTier);
    
    try {
      const analysis = await aiModel.analyze(prompt);
      const template = this.reportTemplates[tierConfig.reportTemplate];
      return template.generateReport(analysis, data, userTier);
    } catch (error) {
      console.error('åˆ†æå¤±è´¥:', error);
      throw error;
    }
  }

  buildTieredPrompt(data, userTier) {
    const basePrompt = this.buildBasePrompt(data);
    
    switch(userTier) {
      case 'FREE':
        return basePrompt + "\n\nè¯·æä¾›ç®€åŒ–çš„åŸºç¡€å»ºè®®ï¼Œæ§åˆ¶åœ¨300å­—å†…ã€‚";
      case 'PREMIUM':
        return basePrompt + "\n\nè¯·æä¾›è¯¦ç»†çš„ä¸“ä¸šåˆ†æï¼ŒåŒ…å«å…·ä½“çš„æ”¹å–„å»ºè®®å’Œæ—¶é—´æ¨èã€‚";
      case 'VIP':
        return basePrompt + "\n\nè¯·æä¾›å¤§å¸ˆçº§åˆ«çš„æ·±åº¦åˆ†æï¼ŒåŒ…å«å¤šè§’åº¦è§£è¯»å’Œä¸ªæ€§åŒ–å»ºè®®ã€‚";
    }
  }
}
```

---

## ğŸ’° é¢„ç®—ä¼°ç®—

### å¼€å‘æˆæœ¬
- **äººåŠ›æˆæœ¬**: $0 (è‡ªä¸»å¼€å‘)
- **ç¬¬ä¸‰æ–¹æœåŠ¡**: ~$50/æœˆ
  - Stripeè´¹ç”¨: 2.9% + $0.30/ç¬”
  - é¢å¤–æœåŠ¡å™¨èµ„æº: $20/æœˆ
  - SSLè¯ä¹¦: $10/æœˆ
- **æ€»å¼€å‘æˆæœ¬**: ~$200å¯åŠ¨èµ„é‡‘

### è¿è¥æˆæœ¬ (æœˆ)
- AI APIè°ƒç”¨: $30-100 (å–å†³äºç”¨æˆ·é‡)
- æœåŠ¡å™¨: $50
- æ”¯ä»˜æ‰‹ç»­è´¹: ~7% æ€»æ”¶å…¥
- **é¢„æœŸå‡€åˆ©æ¶¦ç‡**: 65-70%

---

## ğŸ“ˆ æˆåŠŸæŒ‡æ ‡ (KPIs)

### ç”¨æˆ·è½¬åŒ–
- [ ] æ³¨å†Œè½¬åŒ–ç‡ > 15%
- [ ] å…è´¹â†’ä»˜è´¹è½¬åŒ–ç‡ > 3%
- [ ] è¿›é˜¶â†’é«˜çº§è½¬åŒ–ç‡ > 15%

### ä¸šåŠ¡æŒ‡æ ‡
- [ ] æœˆæ”¶å…¥ç›®æ ‡: $500+
- [ ] ç”¨æˆ·æ»¡æ„åº¦: 4.5/5
- [ ] é€€æ¬¾ç‡: < 5%

### æŠ€æœ¯æŒ‡æ ‡
- [ ] æ”¯ä»˜æˆåŠŸç‡: > 98%
- [ ] ç³»ç»Ÿå¯ç”¨æ€§: > 99%
- [ ] é¡µé¢åŠ è½½æ—¶é—´: < 3ç§’

---

## ğŸš¨ é£é™©ç®¡æ§

### æŠ€æœ¯é£é™©
- **æ”¯ä»˜å®‰å…¨**: ä½¿ç”¨Stripeä¿è¯PCIåˆè§„
- **æ•°æ®ä¿æŠ¤**: GDPRå’Œéšç§æ³•è§„åˆè§„
- **ç³»ç»Ÿç¨³å®š**: å®Œå–„çš„é”™è¯¯å¤„ç†å’Œæ—¥å¿—

### å•†ä¸šé£é™©
- **å¸‚åœºæ¥å—åº¦**: å°æ­¥å¿«è·‘ï¼Œå¿«é€ŸéªŒè¯å’Œè°ƒæ•´
- **ç«äº‰å‹åŠ›**: çªå‡ºAIæŠ€æœ¯ä¼˜åŠ¿å’Œç”¨æˆ·ä½“éªŒ
- **å†…å®¹è´¨é‡**: æŒç»­ä¼˜åŒ–AIæç¤ºè¯å’ŒæŠ¥å‘Šæ¨¡æ¿

---

## ğŸ¯ ä¸‹ä¸€æ­¥è¡ŒåŠ¨

**ç«‹å³å¼€å§‹ç¬¬1å‘¨å¼€å‘**ï¼š
1. åˆ›å»ºç”¨æˆ·è®¤è¯ç³»ç»Ÿ
2. è®¾è®¡ç”¨æˆ·ç­‰çº§ç®¡ç†
3. æ­å»ºåŸºç¡€çš„ä»˜è´¹ç•Œé¢æ¡†æ¶

**ç­‰å¾…æ‚¨çš„ç¡®è®¤åå¼€å§‹æ‰§è¡Œï¼** ğŸš€

---

*è®¡åˆ’åˆ¶å®šæ—¥æœŸ: 2025å¹´9æœˆ2æ—¥*
*é¢„è®¡å®Œæˆæ—¶é—´: 4å‘¨å*